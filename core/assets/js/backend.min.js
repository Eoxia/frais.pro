window.eoxiaJS.fraisPro={},window.eoxiaJS.fraisPro.core={},window.eoxiaJS.fraisPro.core.init=function(){},window.eoxiaJS.fraisPro.core.openedModalProfil=function(e,i){},window.eoxiaJS.fraisPro.line={},window.eoxiaJS.fraisPro.line.init=function(){window.eoxiaJS.fraisPro.line.event()},window.eoxiaJS.fraisPro.line.event=function(){jQuery(document).on("focus",".list-line .form-element:not(.form-element-disable) input[type=text]",window.eoxiaJS.fraisPro.line.selectInputValue),jQuery(document).on("keyup",".list-line .form-element:not(.form-element-disable) input[type=text]",window.eoxiaJS.fraisPro.line.checkInputStatus),jQuery(document).on("blur",".list-line .form-element:not(.form-element-disable) input[type=text]",window.eoxiaJS.fraisPro.line.save)},window.eoxiaJS.fraisPro.line.selectInputValue=function(e,i){jQuery(this).select()},window.eoxiaJS.fraisPro.line.save=function(e,o){if(jQuery(this).closest(".form-element").hasClass("ttc")){var t=math.evaluate(jQuery(this).val());jQuery(this).val(t)}if(jQuery(this).closest(".form-element").hasClass("tva")){t=math.evaluate(jQuery(this).val());jQuery(this).val(t)}var n=(o=o||jQuery(this)).closest("div.line-content"),a=window.eoxiaJS.arrayForm.getInput(n),r={action:"fp_update_line",_wpnonce:n.closest("div.list-line").data("nonce"),id:n.closest("div.line").data("id"),parent_id:n.closest("div.single-note").data("id")};for(jQuery("div.single-note").find(".wpeo-notification")[0].fraisProTimeOut&&clearTimeout(jQuery("div.single-note").find(".wpeo-notification")[0].fraisProTimeOut),n.closest("div.single-note").find(".wpeo-notification").addClass("notification-active"),n.closest("div.single-note").find(".wpeo-notification .notification-title").html(fraisPro.updateInProgress),n.closest("div.single-note").find(".note-last-update").html(fraisPro.updateInProgress),i=0;i<a.length;i++)a[i].name&&(r[a[i].name]=window.eoxiaJS.arrayForm.getInputValue(a[i]));window.eoxiaJS.request.send(jQuery(this),r)},window.eoxiaJS.fraisPro.line.lineSaved=function(e,i){jQuery(".note-recap .note-ttc span.value").html(i.data.note.data.tax_inclusive_amount),jQuery(".note-recap .note-tva span.value").html(i.data.note.data.tax_amount),e.closest(".form-element").hasClass("km")&&(jQuery("div[data-id="+i.data.line.data.id+"] input[name=tax_inclusive_amount]").val(i.data.line.data.tax_inclusive_amount),jQuery("div[data-id="+i.data.line.data.id+"] input[tax_amount]").val(i.data.line.data.tax_amount)),jQuery(".title .note-last-update").html(i.data.note_last_update),jQuery("div.single-note").find(".wpeo-notification .notification-title").html(fraisPro.updateDone),jQuery("div.single-note").find(".wpeo-notification")[0].fraisProTimeOut=setTimeout(function(){jQuery("div.single-note").find(".wpeo-notification").removeClass("notification-active"),jQuery("div.single-note").find(".wpeo-notification .notification-title").html("")},3e3)},window.eoxiaJS.fraisPro.line.displayLine=function(e,i){1===jQuery("div.list-line .table-row.line.notice-info").length&&jQuery("div.list-line .table-row.line.notice-info").hide(),jQuery("div.list-line").prepend(i.data.view)},window.eoxiaJS.fraisPro.line.deleteLineFromDisplay=function(e,i){jQuery(e).closest(".line").fadeOut(function(){window.eoxiaJS.fraisPro.note.checkGotLine(jQuery(e).closest("div.single-note")),jQuery(".single-note[data-id="+i.data.id+"] .note-ttc .value").text(i.data.tax_inclusive_amount),jQuery(".single-note[data-id="+i.data.id+"] .note-tva .value").text(i.data.tax_amount)})},window.eoxiaJS.fraisPro.line.checkInputStatus=function(e){jQuery(this).val();window.eoxiaJS.fraisPro.line.setStatusField(jQuery(this).closest("div.form-element"),!0),window.eoxiaJS.fraisPro.line.checkLineStatus(jQuery(this))},window.eoxiaJS.fraisPro.line.checkLineStatus=function(e){var i=e.closest("div.line-content"),o=i.children("div.status"),t=o.find("span.pin"),n=!1;i.children("div.form-element").each(function(){jQuery(this).hasClass("input-error")&&(n=!0)}),n?t.hasClass("line-error")||(t.removeClass("line-ok"),t.addClass("line-error"),o.attr("aria-label",fraisPro.lineStatusInvalid)):t.hasClass("line-ok")||(t.removeClass("line-error"),t.addClass("line-ok"),o.attr("aria-label",fraisPro.lineStatusValid))},window.eoxiaJS.fraisPro.line.setStatusField=function(e,i){var o=e.find("input").val(),t=!1;e.hasClass("input-is-required")&&(t=!0),t&&i&&(""===o||0==o)?e.addClass("input-error"):e.removeClass("input-error")},window.eoxiaJS.fraisPro.line.setReadOnly=function(e,i,o){o?e.find("."+i).addClass("form-element-disable"):e.find("."+i).removeClass("form-element-disable"),e.find("."+i+" input[type=text]").attr("readonly",o)},window.eoxiaJS.fraisPro.line.eoUploadAssociatedFile=function(e){window.eoxiaJS.upload.currentButton.hasClass("media-grid")?window.eoxiaJS.upload.currentButton=e.element.closest(".line").find(".media.media-list"):window.eoxiaJS.upload.currentButton=e.element.closest(".line").find(".media.media-grid"),window.eoxiaJS.upload.refreshButton(e.response.data)},window.eoxiaJS.fraisPro.lineType={},window.eoxiaJS.fraisPro.lineType.init=function(){window.eoxiaJS.fraisPro.lineType.event()},window.eoxiaJS.fraisPro.lineType.event=function(){jQuery(document).on("click",".type .wpeo-dropdown li",window.eoxiaJS.fraisPro.lineType.select)},window.eoxiaJS.fraisPro.lineType.select=function(e){var i=jQuery(this).closest(".wpeo-dropdown"),o=jQuery(this).closest("div.line-content"),t="",n="";i.find("input").val(jQuery(this).data("id")),i.find(".dropdown-toggle > span").html(jQuery(this).html()),jQuery(this).closest("div.form-element").removeClass("input-error"),n=t=!!jQuery(this).data("special-treatment"),window.eoxiaJS.fraisPro.line.setStatusField(jQuery(this).closest("div.line-content").find(".distance"),n),window.eoxiaJS.fraisPro.line.setStatusField(jQuery(this).closest("div.line-content").find(".ttc"),!n),window.eoxiaJS.fraisPro.line.setStatusField(jQuery(this).closest("div.line-content").find(".tva"),!n),window.eoxiaJS.fraisPro.line.setReadOnly(o,"distance",!t),window.eoxiaJS.fraisPro.line.setReadOnly(o,"ttc",t),window.eoxiaJS.fraisPro.line.setReadOnly(o,"tva",t),window.eoxiaJS.fraisPro.line.checkLineStatus(jQuery(this)),window.eoxiaJS.fraisPro.line.save(void 0,jQuery(this))},window.eoxiaJS.fraisPro.noteUnaffected={},window.eoxiaJS.fraisPro.noteUnaffected.init=function(){jQuery(document).on("click",'.list-line .line input[type="checkbox"]',window.eoxiaJS.fraisPro.noteUnaffected.checkLine),jQuery(document).on("click",".bloc-reassign .wpeo-button",window.eoxiaJS.fraisPro.noteUnaffected.reassignLineUnaffected)},window.eoxiaJS.fraisPro.noteUnaffected.checkLine=function(e){var i=0;jQuery(this).closest(".list-line").find('input[type="checkbox"]').each(function(){jQuery(this).is(":checked")&&i++}),jQuery("span.fp_lines_to_reassign").html(i),window.eoxiaJS.fraisPro.noteUnaffected.buttonState()},window.eoxiaJS.fraisPro.noteUnaffected.reassignLineUnaffected=function(e){var i={},o=[];jQuery("div.single-note").find(".wpeo-notification")[0].fraisProTimeOut&&clearTimeout(jQuery("div.single-note").find(".wpeo-notification")[0].fraisProTimeOut),jQuery(this).closest("div.single-note").find(".wpeo-notification").addClass("notification-active"),jQuery(this).closest("div.single-note").find(".wpeo-notification .notification-title").html(fraisPro.updateInProgress),i.action=jQuery(this).closest(".bloc-reassign").find('input[name="action"]').val(),i._wpnonce=jQuery(this).closest(".bloc-reassign").find('input[name="_wpnonce"]').val(),i._wp_http_referer=jQuery(this).closest(".bloc-reassign").find('input[name="_wp_http_referer"]').val(),i.parent_id=jQuery('input[name="selected_note_id"]').val(),jQuery('.list-line input[type="checkbox"]:checked').each(function(e,i){o.push(jQuery(this).val())}),i.lines_id=o,i.current_note_id=jQuery('.single-note input[name="id"]').val(),window.eoxiaJS.loader.display(jQuery(this)),window.eoxiaJS.request.send(jQuery(this),i)},window.eoxiaJS.fraisPro.noteUnaffected.reassignedLineUnaffectedSuccess=function(e,i){for(var o in window.eoxiaJS.loader.remove(e),e.addClass("button-disable"),jQuery(".bloc-reassign .autocomplete-icon-after").click(),jQuery("span.fp_lines_to_reassign").html(0),i.data.updated_lines_id)jQuery('.list-line .line[data-id="'+i.data.updated_lines_id[o]+'"]').remove();jQuery("div.single-note").find(".wpeo-notification .notification-title").html(fraisPro.lineAffectedSuccessfully),jQuery("div.single-note").find(".wpeo-notification")[0].fraisProTimeOut=setTimeout(function(){jQuery("div.single-note").find(".wpeo-notification").removeClass("notification-active"),jQuery("div.single-note").find(".wpeo-notification .notification-title").html("")},3e3),window.eoxiaJS.fraisPro.note.checkGotLine(jQuery("div.single-note"))},window.eoxiaJS.fraisPro.noteUnaffected.buttonState=function(){var e=0<jQuery('.list-line input[type="checkbox"]:checked').length,i=jQuery("input[name=selected_note_id]").val(),o=jQuery(".bloc-reassign").find(".wpeo-button");e&&i.length?o.removeClass("button-disable"):o.addClass("button-disable")},window.eoxiaJS.fraisPro.note={},window.eoxiaJS.fraisPro.note.currentButton,window.eoxiaJS.fraisPro.note.mediaFrame,window.eoxiaJS.fraisPro.note.focusedElement,window.eoxiaJS.fraisPro.note.selectedInfos=[],window.eoxiaJS.fraisPro.note.init=function(){jQuery(document).on("click",".list-note .note",window.eoxiaJS.fraisPro.note.goToLink),jQuery(document).on("click",".display-method span.wpeo-button",window.eoxiaJS.fraisPro.note.changeDisplayMode),jQuery(document).on("click",".wrap-frais-pro .fraispro-mass-line-creation",window.eoxiaJS.fraisPro.note.openMedia),jQuery(document).on("click",".validation_status.wpeo-dropdown li",window.eoxiaJS.fraisPro.note.changeNoteStatus)},window.eoxiaJS.fraisPro.note.changeNoteStatus=function(e){var o=jQuery(this).closest("div");if(jQuery(this).closest(".single-note").length){var t=window.eoxiaJS.arrayForm.getInput(o),n={action:"fp_update_note",_wpnonce:jQuery(this).closest(".dropdown-content").data("nonce"),id:jQuery(this).closest(".single-note").attr("data-id")};if("closed"===jQuery(this).attr("data-special-treatment")&&!confirm(fraisPro.confirmMarkAsPayed))return!1;jQuery("div.single-note").find(".wpeo-notification")[0].fraisProTimeOut&&clearTimeout(jQuery("div.single-note").find(".wpeo-notification")[0].fraisProTimeOut),jQuery(this).closest("div.single-note").find(".note-last-update").html(fraisPro.updateInProgress),jQuery(this).closest("div.single-note").find(".wpeo-notification").addClass("notification-active"),jQuery(this).closest("div.single-note").find(".wpeo-notification .notification-title").html(fraisPro.updateInProgress)}if(o.find("input").val(jQuery(this).data("id")),o.find(".dropdown-toggle > span").html(jQuery(this).html()),jQuery(this).closest(".single-note").length){for(i=0;i<t.length;i++)t[i].name&&(n[t[i].name]=window.eoxiaJS.arrayForm.getInputValue(t[i]));window.eoxiaJS.request.send(o,n)}},window.eoxiaJS.fraisPro.note.goToLink=function(e){window.location.href=jQuery(this).data("link")},window.eoxiaJS.fraisPro.note.goToNote=function(e,i){window.location.href=i.data.link},window.eoxiaJS.fraisPro.note.changeDisplayMode=function(e){e.preventDefault(),jQuery(this).closest("div.single-note").toggleClass("grid list"),jQuery(this).closest("div.display-method").children("span").toggleClass("active")},window.eoxiaJS.fraisPro.note.openMedia=function(e){window.eoxiaJS.fraisPro.note.currentButton=jQuery(this),e.preventDefault(),window.eoxiaJS.fraisPro.note.mediaFrame=new window.wp.media.view.MediaFrame.Post({}).open(),window.eoxiaJS.fraisPro.note.mediaFrame.on("insert",function(){window.eoxiaJS.fraisPro.note.selectedFile()})},window.eoxiaJS.fraisPro.note.selectedFile=function(e){var i={action:"fp_create_line_from_picture",_wpnonce:window.eoxiaJS.fraisPro.note.currentButton.attr("data-nonce"),files_id:window.eoxiaJS.fraisPro.note.selectedInfos,note_id:window.eoxiaJS.fraisPro.note.currentButton.attr("data-parent-id")};window.eoxiaJS.fraisPro.note.mediaFrame.state().get("selection").map(function(e){window.eoxiaJS.fraisPro.note.selectedInfos.push(e.id)}),jQuery(".single-note").find(".date_modified_value").addClass("loading"),window.eoxiaJS.fraisPro.note.currentButton.addClass("loading"),jQuery.post(window.ajaxurl,i,function(e){window.eoxiaJS.fraisPro.note.currentButton.removeClass("loading"),window.eoxiaJS.fraisPro.note.currentButton=void 0,window.eoxiaJS.fraisPro.note.selectedInfos=[],window.eoxiaJS.fraisPro.note.mediaFrame=void 0,e.success&&jQuery("div.list-line").prepend(e.data.view)},"json")},window.eoxiaJS.fraisPro.note.noteArchived=function(e,i){1===jQuery(".list-note").length?jQuery("tr.note[data-id="+i.data.note.data.id+"]").fadeOut():window.location.href=i.data.link},window.eoxiaJS.fraisPro.note.scrollSticky=function(e){jQuery(window).scrollTop()>=jQuery(".single-note .header").position().top+-20&&jQuery(".single-note .header").addClass("sticky"),jQuery(".single-note .header").hasClass("sticky")&&jQuery(window).scrollTop()<=0&&jQuery(".single-note .header").removeClass("sticky")},window.eoxiaJS.fraisPro.note.exportedfraisProSuccess=function(e,i){jQuery(".document-list-container .notice.notice-info").remove(),jQuery(".document-list-container table.wpeo-table tbody").prepend(i.data.item_view),jQuery(".wpeo-tooltip").remove(),e.closest(".note").find(".note-action").html(i.data.actions_view).find(".wpeo-dropdown.fp-note-export-dropdown").addClass("dropdown-active"),e.closest(".single-note").find(".export.toggle").html(i.data.actions_view).find(".wpeo-dropdown.fp-note-export-dropdown").addClass("dropdown-active")},window.eoxiaJS.fraisPro.note.noteUpdated=function(e,i){jQuery("div.single-note").find(".wpeo-notification .notification-title").html(fraisPro.updateDone),jQuery("div.single-note").find(".wpeo-notification")[0].fraisProTimeOut=setTimeout(function(){jQuery("div.single-note").find(".wpeo-notification").removeClass("notification-active"),jQuery("div.single-note").find(".wpeo-notification .notification-title").html("")},3e3),jQuery("div.single-note").find(".note-last-update").html(i.data.note.data.date_modified.rendered.date_human_readable),"closed"===i.data.status.data.special_treatment&&(window.location.href=i.data.link)},window.eoxiaJS.fraisPro.note.deletedAllLine=function(e,i){e.closest(".note").find(".note-title .count-line").text("("+i.data.countLine+")"),window.eoxiaJS.dropdown.close()},window.eoxiaJS.fraisPro.note.checkGotLine=function(e){0==jQuery(e).find(".wpeo-table.list-line .table-row:visible").length&&jQuery(e).find(".table-row.notice-info").show()},window.eoxiaJS.fraisPro.search={},window.eoxiaJS.fraisPro.search.init=function(){window.eoxiaJS.fraisPro.search.event()},window.eoxiaJS.fraisPro.search.event=function(){jQuery(document).on("click",".autocomplete-search-list li",window.eoxiaJS.fraisPro.search.select),jQuery(document).on("click",".bloc-reassign .autocomplete-search-list li",window.eoxiaJS.fraisPro.search.selectNote),jQuery(document).on("change","input[name=selected_note_id]",window.eoxiaJS.fraisPro.noteUnaffected.buttonState)},window.eoxiaJS.fraisPro.search.select=function(e){var i=jQuery(this).closest(".wpeo-autocomplete");i.find('input[type="hidden"]').val(jQuery(this).data("id")),i.find('input[type="hidden"]').change(),i.find("input.autocomplete-search-input").val(jQuery(this).data("result"))},window.eoxiaJS.fraisPro.search.selectNote=function(e){window.eoxiaJS.fraisPro.noteUnaffected.buttonState()},window.eoxiaJS.fraisPro.search.searchedSuccess=function(e,i){jQuery("table.list-note:not( .list-note-unaffected )").replaceWith(i.data.view)};